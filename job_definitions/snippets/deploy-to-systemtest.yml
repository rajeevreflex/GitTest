- job-template:
    name: '{name}-deploy-to-systemtest'
    parameters:
      - string:
          name: ARTEFACT_VERSION
          default: ""
          description: "The artefact version to deploy"
    project-type: freestyle
    defaults: global
    description: 'Do not edit this job through the web!'
    disabled: false
    display-name: 'Build artefact for {name}'
    node: '{name}'
    properties:
      - build-discarder:
          days-to-keep: 365
          num-to-keep: 100
      - inject:
          properties-content: |
            TF_VAR_environment=systemtest
    wrappers:
      - ansicolor
    scm:
      - '{app_code_repository_type}':
          url: '{config_code_repository_uri}'
          branches:
            - origin/master
          credentials-id: '{config_code_repository_credentials}'
          git-config-name: '{config_code_repository_display_name}'
          git-config-email: '{config_code_repository_display_email}'
          timeout: 5
    builders:
      - shell: !include-raw-escape: deploy-artefact.sh
